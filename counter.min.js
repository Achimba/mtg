function show(e,n){var t=n;null==t&&(t=document.getElementById(e)),null!=t&&t.classList.remove("hidden")}function hide(e,n){var t=n;null==t&&(t=document.getElementById(e)),null!=t&&t.classList.add("hidden")}function playerLayoutDefault(e){for(var n=[null,"100%","50%","33.3%","25%","20%","16.6%","14.28%","12.5%"],t=0;t<e.length;t++)e[t].style.height=n[e.length],e[t].style.display="block"}function playerLayoutHelper(e,n){for(var t=0;t<e.length;t++){var l=e[t].className;e[t].className=l+" "+n[t]}}function playerLayoutTwo(e){e[0].className=e[0].className+" two-t",e[1].className=e[1].className+" two-b"}function playerLayoutThree(e){playerLayoutHelper(e,["four-t-l","four-t-r","four-b-l"])}function playerLayoutFour(e){playerLayoutHelper(e,["four-t-l","four-t-r","four-b-l","four-b-r"])}function playerLayoutFive(e){playerLayoutHelper(e,Array(5).fill("five"))}function playerLayoutSix(e){playerLayoutHelper(e,["six-t-l","six-t-r","six-m-l","six-m-r","six-b-l","six-b-r"])}function playerLayoutSeven(e){playerLayoutHelper(e,Array(7).fill("seven"))}function playerLayoutEight(e){playerLayoutHelper(e,Array(8).fill("eight"))}function setPlayerlayout(){var e=document.getElementsByClassName("active");switch(g_numberPlayers){case 2:playerLayoutTwo(e);break;case 3:playerLayoutThree(e);break;case 4:playerLayoutFour(e);break;case 5:playerLayoutFive(e);break;case 6:playerLayoutSix(e);break;case 7:playerLayoutSeven(e);break;case 8:playerLayoutEight(e);break;default:playerLayoutDefault(e)}}function setStartingLifeTotal(e){for(var n=document.getElementsByClassName("life"),t=0;t<n.length;t++)n[t].innerText=e}function getStartingLifeTotal(e){var n=null;if(null!=e){var t=parseInt(e);n=isNaN(t)?"20":100<t?"100":t<20?"20":e}else{var l=document.getElementById("start_life");null!=(n=l.options[l.selectedIndex].value)&&""!=n||(n="20")}return n}function displayTiles(){for(var e=document.getElementsByClassName("tile"),n=0;n<e.length;n++)e[n].className="tile noise c"+n,animateDead(e[n].children[0]),n<g_numberPlayers?e[n].classList.add("active"):e[n].classList.add("hidden")}function showFirstPlayerDialog(){var e=Math.floor(Math.random()*g_numberPlayers+1);document.getElementById("starting_player_dialog_text").innerText="Player "+e.toString()+" begins!",showMask(),show("starting_player_dialog")}function hideFirstPlayerDialog(){hideMask(),hide("starting_player_dialog")}"serviceWorker"in navigator&&navigator.serviceWorker.register("sw.js").then(function(e){e.installing?console.log("Service worker installing"):e.waiting?console.log("Service worker installed"):e.active&&console.log("Service worker active")}).catch(function(e){console.log("Registration failed with "+e)});var g_numberPlayers=0;function newGame(e){displayTiles(),setStartingLifeTotal(getStartingLifeTotal(e)),setPlayerlayout(),hide("choose"),show("play")}function death(e){e.innerText="",e.classList.add("death"),hide(null,e.nextElementSibling.children[0]),hide(null,e.nextElementSibling.children[1]),show(null,e.nextElementSibling.children[2])}function animateDead(e){e.innerText="1",e.classList.remove("death"),show(null,e.nextElementSibling.children[0]),show(null,e.nextElementSibling.children[1]),hide(null,e.nextElementSibling.children[2])}function displayLife(e,n){n<=0?death(e):e.innerText=n.toString()}function changeLife(e,n){var t=document.getElementById(e),l=t.innerText;displayLife(t,parseInt(l)+parseInt(n))}function plusLife(e){changeLife(e,1)}function minusLife(e){changeLife(e,-1)}function mousedownChangeValue(e){var n=e.dataset.id;e.className.includes("plus")?plusLife(n):e.className.includes("minus")&&minusLife(n)}function toggleFullScreen(){var e=window.document,n=e.documentElement,t=n.requestFullscreen||n.mozRequestFullScreen||n.webkitRequestFullScreen||n.msRequestFullscreen,l=e.exitFullscreen||e.mozCancelFullScreen||e.webkitExitFullscreen||e.msExitFullscreen;e.fullscreenElement||e.mozFullScreenElement||e.webkitFullscreenElement||e.msFullscreenElement?l.call(e):t.call(n)}function replay(e){newGame(),closeSlideMenu(e)}function restart(e){show("choose"),hide("play"),closeSlideMenu(e)}function getParamAndValidate(e,n,t,l){var a=null,i=e.get(n);if(null!=i){var r=parseInt(i);null==r||isNaN(r)?isNaN(r)&&(r=null):l<(a=r)?a=l:a<t&&(a=t)}return a}function handleQueryString(){var e=new URLSearchParams(location.search);if(null!=e&&(e.has("p")||e.has("l"))){var n=getParamAndValidate(e,"p",2,8),t=getParamAndValidate(e,"l",1,999);null!=n&&(g_numberPlayers=n,null==t&&(t=20),newGame(t))}}function handleSwipeLeft(e){null!=g_slideOutMenu&&g_slideOutMenu.close()}function handleSwipeRight(e){null!=g_slideOutMenu&&g_slideOutMenu.open()}function getPlayerTile(e){var n=e.target;if(null!=n&&(n.classList.contains("plus")||n.classList.contains("minus"))){var t=n.parentElement.parentElement;if(null!=t&&t.classList.contains("tile"))return t}return null}function getCurrentColor(e){return null!=e&&e.classList.contains("tile")?window.getComputedStyle(e).getPropertyValue("background-color"):null}function RgbStringToHex(e){var n=(+(e=e.substr(4).split(")")[0].split(","))[0]).toString(16),t=(+e[1]).toString(16),l=(+e[2]).toString(16);return"#"+(n=1==n.length?"0"+n:n)+(t=1==t.length?"0"+t:t)+(l=1==l.length?"0"+l:l)}function handlePressUp(e){var n=getPlayerTile(e);if(null!=n){var t=getCurrentColor(n);if(null!=t)openColorpicker(n,RgbStringToHex(t))}}var g_elPlayerTile=null,g_currentColor=null;function colorSelected(e){var n=e.dataset.color;null!=g_elPlayerTile&&(g_elPlayerTile.style.backgroundColor=n),closeColorpicker()}function showColorpicker(){show("colorpicker")}function hideColorpicker(){hide("colorpicker")}function openColorpicker(e,n){g_elPlayerTile=e,g_currentColor=n,showMask(),showColorpicker();var t=document.getElementById(n);null!=t&&t.focus()}function closeColorpicker(){g_currentColor=g_elPlayerTile=null,hideMask(),hideColorpicker()}function initColorpicker(){for(var e=document.getElementById("colorpicker"),n=["#b22222","#e00000","#d90073","#ce9ae4","#911eb4","#2e86c1","#0000ff","#000080","#138d75","#228b22","#28b463","#016171","#fec007","#fe730e","#fc6f53","#f0e68c","#a0522d","#000000","#6d7a70","#ffffff"],t=0;t<n.length;t++){var l=n[t],a=document.createElement("input");a.id=l,a.type="button",a.className="swatch",a.dataset.color=l,a.style.backgroundColor=l,a.addEventListener("click",function(e){colorSelected(this)},!1),e.appendChild(a)}}function showMask(){show("mask")}function hideMask(){hide("mask")}function initTouchyFeelyHandsyStuff(e){var n=new Hammer(e);n.on("swipeleft",function(e){e.preventDefault(),handleSwipeLeft(e)}),n.on("swiperight",function(e){e.preventDefault(),handleSwipeRight(e)}),n.on("pressup",function(e){e.preventDefault(),handlePressUp(e)})}var g_slideOutMenu=null;function closeSlideMenu(e){e.preventDefault(),null!=g_slideOutMenu&&g_slideOutMenu.close()}window.addEventListener("DOMContentLoaded",function(e){for(var n=document.getElementsByClassName("player-button"),t=0;t<n.length;t++)n[t].addEventListener("click",function(e){g_numberPlayers=parseInt(e.srcElement.value),newGame()},!1);for(var l=["plus","minus"],a=0;a<l.length;a++)for(var i=document.getElementsByClassName(l[a]),r=0;r<i.length;r++){var o=i[r];o.addEventListener("click",function(e){mousedownChangeValue(e.srcElement)},!1),initTouchyFeelyHandsyStuff(o)}for(var s=document.getElementsByClassName("animate"),u=0;u<s.length;u++)s[u].addEventListener("click",function(e){var n=e.srcElement.dataset.id;animateDead(document.getElementById(n))},!1);handleQueryString(),(g_slideOutMenu=new Slideout({panel:document.getElementById("panel"),menu:document.getElementById("menu"),padding:256,tolerance:70})).enableTouch(),g_slideOutMenu.on("beforeopen",function(){this.panel.classList.add("panel-open")}),g_slideOutMenu.on("open",function(){this.panel.addEventListener("click",closeSlideMenu)}),g_slideOutMenu.on("beforeclose",function(){this.panel.classList.remove("panel-open"),this.panel.removeEventListener("click",closeSlideMenu)}),document.getElementById("fullscreen").addEventListener("click",function(e){toggleFullScreen()},!1),document.getElementById("replay").addEventListener("click",function(e){replay(e)},!1),document.getElementById("restart").addEventListener("click",function(e){restart(e)},!1),document.getElementById("random").addEventListener("click",function(e){closeSlideMenu(e),showFirstPlayerDialog()},!1),document.getElementById("starting_player_dialog_button").addEventListener("click",function(e){hideFirstPlayerDialog()},!1),initColorpicker(),document.addEventListener("onselectstart",function(){return!1},!1)});